body.downloadedFiles = []
body.fileNames = []
body.variables = body;
body.fileSizes = [:]
body.fileNameUrlMapping = [:]

body.variables.filesToStore.each {
    def file = it.toURL()?.getBytes()
    body.fileNames << it.substring(it.lastIndexOf('/') + 1).tokenize("?")[0]
    body.fileNameUrlMapping[it.substring(it.lastIndexOf('/') + 1).tokenize("?")[0]] = it
    body.downloadedFiles << file?.encodeBase64()?.toString()
    body.fileSizes[it.substring(it.lastIndexOf('/') + 1).tokenize("?")[0]] = file?.size()
}

return body;